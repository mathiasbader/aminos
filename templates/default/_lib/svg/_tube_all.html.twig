{% set minScore = 4 %}
{% if run.scoreBefore is null or
      run.scoreBefore.baseScores is null %}{% set scoreBefore1 = 0 %}
{% else %}                                 {% set scoreBefore1 = run.scoreBefore.baseScores.nonPolar1 %} {% endif %}
{% if run.scoreBefore is null or
      run.scoreBefore.baseScores is null %}{% set scoreBefore2 = 0 %}
{% else %}                                 {% set scoreBefore2 = run.scoreBefore.baseScores.nonPolar2 %} {% endif %}
{% if run.scoreBefore is null or
      run.scoreBefore.baseScores is null %}{% set scoreBefore3 = 0 %}
{% else %}                                 {% set scoreBefore3 = run.scoreBefore.baseScores.polar %} {% endif %}
{% if run.scoreBefore is null or
      run.scoreBefore.baseScores is null %}{% set scoreBefore4 = 0 %}
{% else %}                                 {% set scoreBefore4 = run.scoreBefore.baseScores.charged %} {% endif %}

<svg xmlns="http://www.w3.org/2000/svg" viewBox="30 54 158 104" style="width: 95%">

    {# First tube: Non polar 1 #}
    <g>
        <path id="bg-white-{{ id }}-1" class="cls-white" d="m56.77,59.9h-19.98v82.5c0,5.51,4.48,9.99,9.99,9.99s9.99-4.48,9.99-9.99V59.9Z"/>
        {% if (id == 1 and scoreBefore1 > minScore) or (id != 1 and run.baseScores.nonPolar1 > minScore) %}
            <path id="fluid-{{ id }}-1"{% if id != 1 and scoreBefore1 <= minScore and run.baseScores.nonPolar1 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-fluidNonPolar" d=""/>
            <path id="glas-black-{{ id }}-1"{% if id != 1 and scoreBefore1 <= minScore and run.baseScores.nonPolar1 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-black" d="m60.08,57.9h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.31v82.5c0,6.61,5.38,11.99,11.99,11.99s11.99-5.38,11.99-11.99V59.9h1.31c.55,0,1-.45,1-1s-.45-1-1-1Zm-3.31,84.5c0,5.51-4.48,9.99-9.99,9.99s-9.99-4.48-9.99-9.99V59.9h19.98v82.5Z"/>
            {% if id == 1 and scoreBefore1 == 100 or run.baseScores.nonPolar1 == 100 %}
                <path id="reflex-{{ id }}-1"{% if id != 1 or scoreBefore1 < 100 %}
                    style="visibility: hidden; opacity: 0; transition: visibility 0s, opacity 0.5s linear"{% endif %}
                      class="cls-reflex" d="m50.16,123.46c.55,0,1-.45,1-1v-39.68c0-.55-.45-1-1-1s-1,.45-1,1v39.68c0,.55.45,1,1,1Zm-1,12.93c0,.55.45,1,1,1s1-.45,1-1v-8.96c0-.55-.45-1-1-1s-1,.45-1,1v8.96Zm.61,3.49c-.12.05-.23.12-.32.21-.19.19-.29.45-.29.71s.1.52.29.71c.09.09.2.16.32.21.13.05.26.08.39.08.26,0,.52-.11.7-.29.19-.19.3-.45.3-.71s-.11-.52-.3-.71c-.27-.28-.72-.37-1.09-.21Zm4.43-64.84c-.02-.07-.09-.11-.16-.1l-3.15.38-.66-3.11c-.01-.07-.08-.12-.15-.12-.06-.01-.13.05-.15.12l-.61,3.12-3.16-.33c-.08,0-.14.04-.16.1-.02.07,0,.14.07.18l2.78,1.54-1.29,2.9c-.03.06,0,.14.05.18.03.02.06.03.09.03.04,0,.07-.01.1-.04l2.33-2.16,2.36,2.13c.05.05.13.05.19,0,.06-.04.08-.12.05-.18l-1.34-2.88,2.75-1.59c.06-.04.09-.11.07-.18Z"/>
            {% endif %}
        {% endif %}
        {% if id != 1 or scoreBefore1 <= minScore %}
            <path id="glas-grey-{{ id }}-1"{% if id != 1 and scoreBefore1 > minScore and run.baseScores.nonPolar1 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-glasGrey" d="m60.08,57.9h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.31v82.5c0,6.61,5.38,11.99,11.99,11.99s11.99-5.38,11.99-11.99V59.9h1.31c.55,0,1-.45,1-1s-.45-1-1-1Zm-3.31,84.5c0,5.51-4.48,9.99-9.99,9.99s-9.99-4.48-9.99-9.99V59.9h19.98v82.5Z"/>
        {% endif %}
    </g>

    {# Second tube: Non polar 2 #}
    <g>
        <path id="bg-white-{{ id }}-2" class="cls-white" d="m88.02,59.9h-19.98v82.5c0,5.51,4.48,9.99,9.99,9.99s9.99-4.48,9.99-9.99V59.9Z"/>
        {% if (id == 1 and scoreBefore2 > minScore) or (id != 1 and run.baseScores.nonPolar2 > minScore) %}
            <path id="fluid-{{ id }}-2"{% if id != 1 and scoreBefore2 <= minScore and run.baseScores.nonPolar2 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-fluidNonPolar" d=""/>
            <path id="glas-black-{{ id }}-2"{% if id != 1 and scoreBefore2 <= minScore and run.baseScores.nonPolar2 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-black" d="m91.33,57.9h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.31v82.5c0,6.61,5.38,11.99,11.99,11.99s11.99-5.38,11.99-11.99V59.9h1.31c.55,0,1-.45,1-1s-.45-1-1-1Zm-3.31,84.5c0,5.51-4.48,9.99-9.99,9.99s-9.99-4.48-9.99-9.99V59.9h19.98v82.5Z"/>
            {% if id == 1 and scoreBefore2 == 100 or run.baseScores.nonPolar2 == 100 %}
                <path id="reflex-{{ id }}-2"{% if id != 1 or scoreBefore2 < 100 %}
                    style="visibility: hidden; opacity: 0; transition: visibility 0s, opacity 0.5s linear"{% endif %}
                      class="cls-reflex" d="m81.42,123.46c.55,0,1-.45,1-1v-39.68c0-.55-.45-1-1-1s-1,.45-1,1v39.68c0,.55.45,1,1,1Zm-1,12.93c0,.55.45,1,1,1s1-.45,1-1v-8.96c0-.55-.45-1-1-1s-1,.45-1,1v8.96Zm.61,3.49c-.12.05-.23.12-.32.21-.19.19-.29.45-.29.71s.1.52.29.71c.09.09.2.16.32.21.13.05.26.08.39.08.26,0,.52-.11.7-.29.19-.19.3-.45.3-.71s-.11-.52-.3-.71c-.27-.28-.72-.37-1.09-.21Zm4.43-64.84c-.02-.07-.09-.11-.16-.1l-3.15.38-.66-3.11c-.01-.07-.08-.12-.15-.12-.06-.01-.13.05-.15.12l-.61,3.12-3.16-.33c-.08,0-.14.04-.16.1-.02.07,0,.14.07.18l2.78,1.54-1.29,2.9c-.03.06,0,.14.05.18.03.02.06.03.09.03.04,0,.07-.01.1-.04l2.33-2.16,2.36,2.13c.05.05.13.05.19,0,.06-.04.08-.12.05-.18l-1.34-2.88,2.75-1.59c.06-.04.09-.11.07-.18Z"/>
            {% endif %}
        {% endif %}
        {% if id != 1 or scoreBefore2 <= minScore %}
            <path id="glas-grey-{{ id }}-2"{% if id != 1 and scoreBefore2 > minScore and run.baseScores.nonPolar2 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-glasGrey" d="m91.33,57.9h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.31v82.5c0,6.61,5.38,11.99,11.99,11.99s11.99-5.38,11.99-11.99V59.9h1.31c.55,0,1-.45,1-1s-.45-1-1-1Zm-3.31,84.5c0,5.51-4.48,9.99-9.99,9.99s-9.99-4.48-9.99-9.99V59.9h19.98v82.5Z"/>
        {% endif %}
    </g>


    {# Third tube: Polar #}
    <g>
        <path id="bg-white-{{ id }}-3" class="cls-white" d="m126.13,95.95c-.06-.19-.1-.48-.1-.78v-18.1h-19.47v18.1c0,.3-.04.59-.12.88l-10,52.71c-.16.84.06,1.7.61,2.35s1.35,1.03,2.2,1.03h34.12c.85,0,1.66-.38,2.2-1.03s.77-1.52.61-2.35l-10.03-52.8Z"/>
        {% if (id == 1 and scoreBefore3 > minScore) or (id != 1 and run.baseScores.polar > minScore) %}
            <path id="fluid-{{ id }}-3"{% if id != 1 and scoreBefore3 <= minScore and run.baseScores.polar > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-fluidPolar" d=""/>
            <path id="glas-black-{{ id }}-3"{% if id != 1 and scoreBefore3 <= minScore and run.baseScores.polar > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-black" d="m138.12,148.38l-10.05-52.89c-.03-.1-.04-.21-.04-.31v-18.1h1.56c.55,0,1-.45,1-1s-.45-1-1-1h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.56v18.1c0,.11-.01.21-.07.41l-10.03,52.8c-.27,1.43.1,2.88,1.03,4,.93,1.12,2.29,1.76,3.74,1.76h34.12c1.45,0,2.81-.64,3.74-1.76.93-1.12,1.3-2.58,1.03-4Zm-2.57,2.73c-.54.66-1.35,1.03-2.2,1.03h-34.12c-.85,0-1.66-.38-2.2-1.03s-.77-1.52-.61-2.35l10-52.71c.08-.28.12-.58.12-.88v-18.1h19.47v18.1c0,.3.04.59.1.78l10.03,52.8c.16.84-.06,1.7-.61,2.35Z"/>
            {% if id == 1 and scoreBefore3 == 100 or run.baseScores.polar == 100 %}
                <path id="reflex-{{ id }}-3"{% if id != 1 or scoreBefore3 < 100 %}
                    style="visibility: hidden; opacity: 0; transition: visibility 0s, opacity 0.5s linear"{% endif %}
                      class="cls-reflex" d="m119.15,128.65c.55,0,1-.45,1-1v-28.07c0-.55-.45-1-1-1s-1,.45-1,1v28.07c0,.55.45,1,1,1Zm-1,13.94c0,.55.45,1,1,1s1-.45,1-1v-8.96c0-.55-.45-1-1-1s-1,.45-1,1v8.96Zm.61,2.49c-.12.05-.23.12-.32.21-.19.19-.29.45-.29.71s.1.52.29.71c.09.09.2.16.32.21.13.05.26.08.39.08.26,0,.52-.11.7-.29.19-.19.3-.45.3-.71s-.11-.52-.3-.71c-.27-.28-.72-.37-1.09-.21Zm4.43-54.1c-.02-.07-.09-.11-.16-.1l-3.15.38-.66-3.11c-.01-.07-.08-.12-.15-.12-.06-.01-.13.05-.15.12l-.61,3.12-3.16-.33c-.08,0-.14.04-.16.1-.02.07,0,.14.07.18l2.78,1.54-1.29,2.9c-.03.06,0,.14.05.18.03.02.06.03.09.03.04,0,.07-.01.1-.04l2.33-2.16,2.36,2.13c.05.05.13.05.19,0,.06-.04.08-.12.05-.18l-1.34-2.88,2.75-1.59c.06-.04.09-.11.07-.18Z"/>
            {% endif %}
        {% endif %}
        {% if id != 1 or scoreBefore3 <= minScore %}
            <path id="glas-grey-{{ id }}-3"{% if id != 1 and scoreBefore3 > minScore and run.baseScores.polar > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-glasGrey" d="m138.12,148.38l-10.05-52.89c-.03-.1-.04-.21-.04-.31v-18.1h1.56c.55,0,1-.45,1-1s-.45-1-1-1h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.56v18.1c0,.11-.01.21-.07.41l-10.03,52.8c-.27,1.43.1,2.88,1.03,4,.93,1.12,2.29,1.76,3.74,1.76h34.12c1.45,0,2.81-.64,3.74-1.76.93-1.12,1.3-2.58,1.03-4Zm-2.57,2.73c-.54.66-1.35,1.03-2.2,1.03h-34.12c-.85,0-1.66-.38-2.2-1.03s-.77-1.52-.61-2.35l10-52.71c.08-.28.12-.58.12-.88v-18.1h19.47v18.1c0,.3.04.59.1.78l10.03,52.8c.16.84-.06,1.7-.61,2.35Z"/>
        {% endif %}
    </g>

    {# Fourth tube: Charged #}
    <g>
        <path id="bg-white-{{ id }}-4"  class="cls-white" d="m155.74,152.14h14.36c6.32,0,11.46-5.14,11.46-11.46v-54.04h-37.28v54.04c0,6.32,5.14,11.46,11.46,11.46Z"/>
        {% if (id == 1 and scoreBefore4 > minScore) or (id != 1 and run.baseScores.charged > minScore) %}
            <path id="fluid-{{ id }}-4"{% if id != 1 and scoreBefore4 <= minScore and run.baseScores.charged > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-fluidCharged" d=""/>
            <path id="glas-black-{{ id }}-4"{% if id != 1 and scoreBefore4 <= minScore and run.baseScores.charged > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-black" d="m183.68,84.64h-41.52c-.55,0-1,.45-1,1s.45,1,1,1h.12v54.04c0,7.42,6.04,13.46,13.46,13.46h14.36c7.42,0,13.46-6.04,13.46-13.46v-54.04h.12c.55,0,1-.45,1-1s-.45-1-1-1Zm-2.12,56.04c0,6.32-5.14,11.46-11.46,11.46h-14.36c-6.32,0-11.46-5.14-11.46-11.46v-54.04h37.28v54.04Z"/>
            {% if id == 1 and scoreBefore4 == 100 or run.baseScores.charged == 100 %}
                <path id="reflex-{{ id }}-4"{% if id != 1 or scoreBefore4 < 100 %}
                    style="visibility: hidden; opacity: 0; transition: visibility 0s, opacity 0.5s linear"{% endif %}
                      class="cls-reflex" d="m170.07,122.03c.55,0,1-.45,1-1v-13.84c0-.55-.45-1-1-1s-1,.45-1,1v13.84c0,.55.45,1,1,1Zm-1,11.94c0,.55.45,1,1,1s1-.45,1-1v-8.96c0-.55-.45-1-1-1s-1,.45-1,1v8.96Zm.61,4.49c-.12.05-.23.12-.32.21-.19.19-.29.45-.29.71s.1.52.29.71c.09.09.2.16.32.21.13.05.26.08.39.08.26,0,.52-.11.7-.29.19-.19.3-.45.3-.71s-.11-.52-.3-.71c-.27-.28-.72-.37-1.09-.21Zm4.43-37.17c-.02-.07-.09-.11-.16-.1l-3.15.38-.66-3.11c-.01-.07-.08-.12-.15-.12-.06-.01-.13.05-.15.12l-.61,3.12-3.16-.33c-.08,0-.14.04-.16.1-.02.07,0,.14.07.18l2.78,1.54-1.29,2.9c-.03.06,0,.14.05.18.03.02.06.03.09.03.04,0,.07-.01.1-.04l2.33-2.16,2.36,2.13c.05.05.13.05.19,0,.06-.04.08-.12.05-.18l-1.34-2.88,2.75-1.59c.06-.04.09-.11.07-.18Z"/>
            {% endif %}
        {% endif %}
        {% if id != 1 or scoreBefore4 <= minScore %}
            <path id="glas-grey-{{ id }}-4"{% if id != 1 and scoreBefore4 > minScore and run.baseScores.charged > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-glasGrey" d="m183.68,84.64h-41.52c-.55,0-1,.45-1,1s.45,1,1,1h.12v54.04c0,7.42,6.04,13.46,13.46,13.46h14.36c7.42,0,13.46-6.04,13.46-13.46v-54.04h.12c.55,0,1-.45,1-1s-.45-1-1-1Zm-2.12,56.04c0,6.32-5.14,11.46-11.46,11.46h-14.36c-6.32,0-11.46-5.14-11.46-11.46v-54.04h37.28v54.04Z"/>
        {% endif %}
    </g>
</svg>
