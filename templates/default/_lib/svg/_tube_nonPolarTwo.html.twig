{% set minScore = 4 %}
{% if run.scoreBefore is null or
      run.scoreBefore.baseScores is null %}{% set scoreBefore1 = 0 %}
{% else %}                                 {% set scoreBefore1 = run.scoreBefore.baseScores.nonPolar1 %} {% endif %}
{% if run.scoreBefore is null or
      run.scoreBefore.baseScores is null %}{% set scoreBefore2 = 0 %}
{% else %}                                 {% set scoreBefore2 = run.scoreBefore.baseScores.nonPolar2 %} {% endif %}

<svg xmlns="http://www.w3.org/2000/svg" viewBox="30 54 66 104" style="width: 80%">

    {# First non polar tube #}
    <g>
        <path id="bg-white-{{ id }}-1" class="cls-white" d="m56.77,59.9h-19.98v82.5c0,5.51,4.48,9.99,9.99,9.99s9.99-4.48,9.99-9.99V59.9Z"/>
        {% if (id == 1 and scoreBefore1 > minScore) or (id != 1 and run.baseScores.nonPolar1 > minScore) %}
            <path id="fluid-{{ id }}-1"{% if id != 1 and scoreBefore1 <= minScore and run.baseScores.nonPolar1 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-fluidNonPolar" d=""/>
            <path id="glas-black-{{ id }}-1"{% if id != 1 and scoreBefore1 <= minScore and run.baseScores.nonPolar1 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-black" d="m60.08,57.9h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.31v82.5c0,6.61,5.38,11.99,11.99,11.99s11.99-5.38,11.99-11.99V59.9h1.31c.55,0,1-.45,1-1s-.45-1-1-1Zm-3.31,84.5c0,5.51-4.48,9.99-9.99,9.99s-9.99-4.48-9.99-9.99V59.9h19.98v82.5Z"/>
            {% if id == 1 and scoreBefore1 == 100 or run.baseScores.nonPolar1 == 100 %}
                <path id="reflex-{{ id }}-1"{% if id != 1 or scoreBefore1 < 100 %}
                    style="visibility: hidden; opacity: 0; transition: visibility 0s, opacity 0.5s linear"{% endif %}
                      class="cls-reflex" d="m50.16,123.46c.55,0,1-.45,1-1v-39.68c0-.55-.45-1-1-1s-1,.45-1,1v39.68c0,.55.45,1,1,1Zm-1,12.93c0,.55.45,1,1,1s1-.45,1-1v-8.96c0-.55-.45-1-1-1s-1,.45-1,1v8.96Zm.61,3.49c-.12.05-.23.12-.32.21-.19.19-.29.45-.29.71s.1.52.29.71c.09.09.2.16.32.21.13.05.26.08.39.08.26,0,.52-.11.7-.29.19-.19.3-.45.3-.71s-.11-.52-.3-.71c-.27-.28-.72-.37-1.09-.21Zm4.43-64.84c-.02-.07-.09-.11-.16-.1l-3.15.38-.66-3.11c-.01-.07-.08-.12-.15-.12-.06-.01-.13.05-.15.12l-.61,3.12-3.16-.33c-.08,0-.14.04-.16.1-.02.07,0,.14.07.18l2.78,1.54-1.29,2.9c-.03.06,0,.14.05.18.03.02.06.03.09.03.04,0,.07-.01.1-.04l2.33-2.16,2.36,2.13c.05.05.13.05.19,0,.06-.04.08-.12.05-.18l-1.34-2.88,2.75-1.59c.06-.04.09-.11.07-.18Z"/>
            {% endif %}
        {% endif %}
        {% if id != 1 or scoreBefore1 <= minScore %}
            <path id="glas-grey-{{ id }}-1"{% if id != 1 and scoreBefore1 > minScore and run.baseScores.nonPolar1 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-glasGrey" d="m60.08,57.9h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.31v82.5c0,6.61,5.38,11.99,11.99,11.99s11.99-5.38,11.99-11.99V59.9h1.31c.55,0,1-.45,1-1s-.45-1-1-1Zm-3.31,84.5c0,5.51-4.48,9.99-9.99,9.99s-9.99-4.48-9.99-9.99V59.9h19.98v82.5Z"/>
        {% endif %}
    </g>

    {# Second non polar tube #}
    <g>
        <path id="bg-white-{{ id }}-2" class="cls-white" d="m88.02,59.9h-19.98v82.5c0,5.51,4.48,9.99,9.99,9.99s9.99-4.48,9.99-9.99V59.9Z"/>
        {% if (id == 1 and scoreBefore2 > minScore) or (id != 1 and run.baseScores.nonPolar2 > minScore) %}
            <path id="fluid-{{ id }}-2"{% if id != 1 and scoreBefore2 <= minScore and run.baseScores.nonPolar2 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-fluidNonPolar" d=""/>
            <path id="glas-black-{{ id }}-2"{% if id != 1 and scoreBefore2 <= minScore and run.baseScores.nonPolar2 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-black" d="m91.33,57.9h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.31v82.5c0,6.61,5.38,11.99,11.99,11.99s11.99-5.38,11.99-11.99V59.9h1.31c.55,0,1-.45,1-1s-.45-1-1-1Zm-3.31,84.5c0,5.51-4.48,9.99-9.99,9.99s-9.99-4.48-9.99-9.99V59.9h19.98v82.5Z"/>
            {% if id == 1 and scoreBefore2 == 100 or run.baseScores.nonPolar2 == 100 %}
                <path id="reflex-{{ id }}-2"{% if id != 1 or scoreBefore2 < 100 %}
                    style="visibility: hidden; opacity: 0; transition: visibility 0s, opacity 0.5s linear"{% endif %}
                      class="cls-reflex" d="m81.42,123.46c.55,0,1-.45,1-1v-39.68c0-.55-.45-1-1-1s-1,.45-1,1v39.68c0,.55.45,1,1,1Zm-1,12.93c0,.55.45,1,1,1s1-.45,1-1v-8.96c0-.55-.45-1-1-1s-1,.45-1,1v8.96Zm.61,3.49c-.12.05-.23.12-.32.21-.19.19-.29.45-.29.71s.1.52.29.71c.09.09.2.16.32.21.13.05.26.08.39.08.26,0,.52-.11.7-.29.19-.19.3-.45.3-.71s-.11-.52-.3-.71c-.27-.28-.72-.37-1.09-.21Zm4.43-64.84c-.02-.07-.09-.11-.16-.1l-3.15.38-.66-3.11c-.01-.07-.08-.12-.15-.12-.06-.01-.13.05-.15.12l-.61,3.12-3.16-.33c-.08,0-.14.04-.16.1-.02.07,0,.14.07.18l2.78,1.54-1.29,2.9c-.03.06,0,.14.05.18.03.02.06.03.09.03.04,0,.07-.01.1-.04l2.33-2.16,2.36,2.13c.05.05.13.05.19,0,.06-.04.08-.12.05-.18l-1.34-2.88,2.75-1.59c.06-.04.09-.11.07-.18Z"/>
            {% endif %}
        {% endif %}
        {% if id != 1 or scoreBefore2 <= minScore %}
            <path id="glas-grey-{{ id }}-2"{% if id != 1 and scoreBefore2 > minScore and run.baseScores.nonPolar2 > minScore %} style="visibility: hidden;"{% endif %}
                  class="cls-glasGrey" d="m91.33,57.9h-26.6c-.55,0-1,.45-1,1s.45,1,1,1h1.31v82.5c0,6.61,5.38,11.99,11.99,11.99s11.99-5.38,11.99-11.99V59.9h1.31c.55,0,1-.45,1-1s-.45-1-1-1Zm-3.31,84.5c0,5.51-4.48,9.99-9.99,9.99s-9.99-4.48-9.99-9.99V59.9h19.98v82.5Z"/>
        {% endif %}
    </g>
</svg>
